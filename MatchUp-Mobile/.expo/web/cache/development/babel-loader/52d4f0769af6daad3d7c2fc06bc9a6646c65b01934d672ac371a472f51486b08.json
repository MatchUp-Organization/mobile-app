{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport * as React from 'react';\nimport CustomButton from \"../CustomButton\";\nimport * as WebBrowser from \"expo-web-browser\";\nimport * as Google from 'expo-auth-session/providers/google';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useNavigation, useRoute } from '@react-navigation/native';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nvar SocialSignInButtons = function SocialSignInButtons() {\n  var _React$useState = React.useState(null),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    userInfo = _React$useState2[0],\n    setUserInfo = _React$useState2[1];\n  WebBrowser.maybeCompleteAuthSession();\n  var navigation = useNavigation();\n  var _React$useState3 = React.useState(false),\n    _React$useState4 = _slicedToArray(_React$useState3, 2),\n    isSignedIn = _React$useState4[0],\n    setIsSignedIn = _React$useState4[1];\n  var _Google$useAuthReques = Google.useAuthRequest({\n      webClientId: \"871816637044-ejvmsf74rnf29sludjqr7t60tne94sam.apps.googleusercontent.com\",\n      scopes: [\"profile\", \"email\"]\n    }),\n    _Google$useAuthReques2 = _slicedToArray(_Google$useAuthReques, 3),\n    request = _Google$useAuthReques2[0],\n    response = _Google$useAuthReques2[1],\n    promptAsync = _Google$useAuthReques2[2];\n  React.useEffect(function () {\n    var checkSignInStatus = function () {\n      var _ref = _asyncToGenerator(function* () {\n        var userJSON = yield AsyncStorage.getItem(\"user\");\n        if (userJSON) {\n          setIsSignedIn(true);\n        } else {\n          setIsSignedIn(false);\n        }\n      });\n      return function checkSignInStatus() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    checkSignInStatus();\n  }, []);\n  var getUserInfo = function () {\n    var _ref2 = _asyncToGenerator(function* (token) {\n      if (!token) return;\n      try {\n        var _response = yield fetch(\"https://www.googleapis.com/userinfo/v2/me\", {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        var _user = yield _response.json();\n        yield AsyncStorage.setItem(\"user\", JSON.stringify(_user));\n        setUserInfo(_user);\n      } catch (error) {\n        console.error(\"Failed to fetch user data:\", response.status, response.statusText);\n      }\n    });\n    return function getUserInfo(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var onSignInFacebook = function onSignInFacebook() {\n    console.warn(\"Facebook\");\n    navigation.navigate('Home');\n  };\n  var onSignInGoogle = function () {\n    var _ref3 = _asyncToGenerator(function* () {\n      try {\n        var userJSON = yield AsyncStorage.getItem(\"user\");\n        if (userJSON) {\n          setUserInfo(JSON.parse(userJSON));\n          setIsSignedIn(true);\n        } else if ((response == null ? void 0 : response.type) === \"success\") {\n          getUserInfo(response.authentication.accessToken);\n          setIsSignedIn(true);\n        }\n      } catch (error) {\n        console.error(\"Error retrieving user data from AsyncStorage:\", error);\n      }\n      useEffect(function () {\n        onSignInGoogle();\n      }, [response]);\n      setUserInfo(user);\n      console.log(JSON.stringify(userInfo));\n    });\n    return function onSignInGoogle() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var onSignInApple = function onSignInApple() {\n    console.warn(\"Apple\");\n  };\n  return _jsxs(_Fragment, {\n    children: [_jsx(CustomButton, {\n      text: \"Sign In With Facebook\",\n      onPress: onSignInFacebook,\n      bgColor: \"#E7EAF4\",\n      fgColor: \"#4765A9\"\n    }), !userInfo ? _jsx(CustomButton, {\n      text: \"Sign In With Google\",\n      onPress: function onPress(onSignInGoogle) {\n        promptAsync({\n          useProxy: false,\n          showInRecents: true\n        });\n      },\n      bgColor: \"#FAE9EA\",\n      fgColor: \"#DD4D44\"\n    }) : _jsxs(View, {\n      style: styles.card,\n      children: [(userInfo == null ? void 0 : userInfo.picture) && _jsx(Image, {\n        source: {\n          uri: userInfo == null ? void 0 : userInfo.picture\n        },\n        style: styles.image\n      }), _jsxs(Text, {\n        style: styles.text,\n        children: [\"Email: \", userInfo.email]\n      }), _jsxs(Text, {\n        style: styles.text,\n        children: [\"Verified: \", userInfo.verified_email ? \"yes\" : \"no\"]\n      }), _jsxs(Text, {\n        style: styles.text,\n        children: [\"Name: \", userInfo.name]\n      })]\n    }), _jsx(CustomButton, {\n      text: \"Sign In with Apple\",\n      onPress: onSignInApple,\n      bgColor: \"#E3E3E3\",\n      fgColor: \"#363636\"\n    }), _jsx(CustomButton, {\n      text: \"remove local store\",\n      onPress: _asyncToGenerator(function* () {\n        return yield AsyncStorage.removeItem(\"@user\");\n      })\n    })]\n  });\n};\nexport default SocialSignInButtons;","map":{"version":3,"names":["React","CustomButton","WebBrowser","Google","AsyncStorage","useNavigation","useRoute","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","SocialSignInButtons","_React$useState","useState","_React$useState2","_slicedToArray","userInfo","setUserInfo","maybeCompleteAuthSession","navigation","_React$useState3","_React$useState4","isSignedIn","setIsSignedIn","_Google$useAuthReques","useAuthRequest","webClientId","scopes","_Google$useAuthReques2","request","response","promptAsync","useEffect","checkSignInStatus","_ref","_asyncToGenerator","userJSON","getItem","apply","arguments","getUserInfo","_ref2","token","fetch","headers","Authorization","user","json","setItem","JSON","stringify","error","console","status","statusText","_x","onSignInFacebook","warn","navigate","onSignInGoogle","_ref3","parse","type","authentication","accessToken","log","onSignInApple","children","text","onPress","bgColor","fgColor","useProxy","showInRecents","View","style","styles","card","picture","Image","source","uri","image","Text","email","verified_email","name","removeItem"],"sources":["/home/alexx/MatchUp-Mobile/src/components/SocialSignInButtons/SocialSignInButtons.js"],"sourcesContent":["import { View, Text } from 'react-native'\nimport * as React from 'react'\nimport CustomButton from '../CustomButton'\nimport * as WebBrowser from \"expo-web-browser\";\nimport * as Google from 'expo-auth-session/providers/google';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { useNavigation, useRoute } from '@react-navigation/native';\n\n\nconst SocialSignInButtons = () => {\n  \n  const [userInfo, setUserInfo] = React.useState(null);\n  WebBrowser.maybeCompleteAuthSession();\n  const navigation = useNavigation();\n  const [isSignedIn, setIsSignedIn] = React.useState(false);\n\n\n  const [request, response, promptAsync] = Google.useAuthRequest({\n\n    webClientId:\"871816637044-ejvmsf74rnf29sludjqr7t60tne94sam.apps.googleusercontent.com\",\n    scopes: [\"profile\", \"email\"]\n\n  });\n\n  React.useEffect(() => {\n    const checkSignInStatus = async () => {\n      const userJSON = await AsyncStorage.getItem(\"user\");\n      if (userJSON) {\n        setIsSignedIn(true);\n      } else {\n        setIsSignedIn(false);\n      }\n    };\n  \n    checkSignInStatus();\n  }, []);\n\n\n  const getUserInfo = async (token) => {\n    //absent token\n    if (!token) return;\n    //present token\n    try {\n      const response = await fetch(\n        \"https://www.googleapis.com/userinfo/v2/me\",\n        {\n          headers: { Authorization: `Bearer ${token}` },\n        }\n      );\n      const user = await response.json();\n      //store user information  in Asyncstorage\n      await AsyncStorage.setItem(\"user\", JSON.stringify(user));\n      setUserInfo(user);\n    } catch (error) {\n      console.error(\n        \"Failed to fetch user data:\",\n        response.status,\n        response.statusText\n      );\n    }\n  };\n\n  const onSignInFacebook = () => {\n      console.warn(\"Facebook\");\n      navigation.navigate('Home');\n\n    }\n\n    const onSignInGoogle = async () => {\n      try {\n        // Attempt to retrieve user information from AsyncStorage\n        const userJSON = await AsyncStorage.getItem(\"user\");\n    \n        if (userJSON) {\n          // If user information is found in AsyncStorage, parse it and set it in the state\n          setUserInfo(JSON.parse(userJSON));\n          setIsSignedIn(true);\n        } else if (response?.type === \"success\") {\n          // If no user information is found and the response type is \"success\" (assuming response is defined),\n          // call getUserInfo with the access token from the response\n          getUserInfo(response.authentication.accessToken);\n          setIsSignedIn(true);\n\n        }\n      } catch (error) {\n        // Handle any errors that occur during AsyncStorage retrieval or other operations\n        console.error(\"Error retrieving user data from AsyncStorage:\", error);\n      }\n    //add it to a useEffect with response as a dependency \n    useEffect(() => {\n      onSignInGoogle();\n    }, [response]);\n    setUserInfo(user);\n    \n    //log the userInfo to see user details\n    console.log(JSON.stringify(userInfo))\n    };\n\n    const onSignInApple= () => {\n      console.warn(\"Apple\");\n    }\n\n\n  return (\n  <>\n      \n      <CustomButton \n      text= \"Sign In With Facebook\" \n      onPress={onSignInFacebook}\n      bgColor=\"#E7EAF4\"\n      fgColor=\"#4765A9\"\n      />\n      \n            {!userInfo ? (\n\n      <CustomButton \n      text= \"Sign In With Google\" \n      onPress={onSignInGoogle => {\n        promptAsync({ useProxy: false, showInRecents: true });\n      }}\n      bgColor=\"#FAE9EA\"\n      fgColor=\"#DD4D44\"\n      />\n    ):(\n      <View style={styles.card}>\n          {userInfo?.picture && (\n            <Image source={{ uri: userInfo?.picture }} style={styles.image} />\n          )}\n          <Text style={styles.text}>Email: {userInfo.email}</Text>\n          <Text style={styles.text}>\n            Verified: {userInfo.verified_email ? \"yes\" : \"no\"}\n          </Text>\n          <Text style={styles.text}>Name: {userInfo.name}</Text>\n          {/* <Text style={styles.text}>{JSON.stringify(userInfo, null, 2)}</Text> */}\n        </View>\n    )}\n      <CustomButton \n      text= \"Sign In with Apple\" \n      onPress={onSignInApple}\n      bgColor=\"#E3E3E3\"\n      fgColor=\"#363636\"\n      />\n      <CustomButton\n        text=\"remove local store\"\n        onPress={async () => await AsyncStorage.removeItem(\"@user\")}\n      />    \n  </>\n)\n}\n\n\nexport default SocialSignInButtons"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}